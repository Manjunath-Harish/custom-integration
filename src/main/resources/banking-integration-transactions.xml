<routes xmlns="http://camel.apache.org/schema/spring">
    <route id="rb_integration_getAccountTransactions">
        <!--This route XML was autogenerated generated by Integration Editor Tool on  Tue, 26 Mar 2019 9:52 AM-->
        <!--Manual changes to this may cause incorrect behaviour and will loose the changes when route updated through the editor tool.-->
        <from uri="direct:rb_integration_getAccountTransactions"/>
        <setProperty propertyName="objectMapper">
            <constant>[{"id":"res_txn_inquiry","sourceClass":"com.morfeus.rb_integration_getAccountTransactions.model.AccountTransactionsResponse","destinationClass":"com.morfeus.banking.retail.domain.transaction.TransactionInquiryResponse","fieldMapping":{"result.messageCode":"errorCode","result.message":"errorDescription","accountTransactions{txnDate}":"transactions{transactionDate}","accountTransactions{category}":"transactions{accountCategory}","accountTransactions{amount}":"transactions{transactionAmount.amount}","accountTransactions{currency}":"transactions{transactionAmount.currency}","accountTransactions{foreignTxnAmount}":"transactions{foreignTransactionAmount.amount}","accountTransactions{foreignTxnExchangeRate}":"transactions{foreignExchangeRate.amount}","accountTransactions{foreignTxnCurrency}":"transactions{foreignExchangeRate.currency}"},"childMapping":[]}]
            </constant>
        </setProperty>
        <setProperty propertyName="responseClass">
            <constant>com.morfeus.rb_integration_getAccountTransactions.model.AccountTransactionsResponse
            </constant>
        </setProperty>
        <setProperty propertyName="responseMapperId">
            <constant>res_txn_inquiry
            </constant>
        </setProperty>
        <setHeader headerName="CamelHttpMethod">
            <constant>get
            </constant>
        </setHeader>
        <setHeader headerName="Content-Type">
            <constant>application/json
            </constant>
        </setHeader>
        <setHeader headerName="accept">
            <constant>application/json
            </constant>
        </setHeader>
        <doTry>
            <setProperty propertyName="apiRequestObject">
                <simple>${body}
                </simple>
            </setProperty>
            <bean method="marshallToRestRequest(${body},${header.Content-Type})" ref="unmarshallBean"/>
            <log logName="com.morfeus.banking" loggingLevel="INFO" message="After request marshalling ${body}"/>
            <to uri="http4://84a81549.ngrok.io/bankingIntegration/v1/1/accounts/2/statement"/>
            <convertBodyTo type="java.lang.String"/>
            <setProperty propertyName="apiResponseObject">
                <simple>${body}
                </simple>
            </setProperty>
            <log logName="com.morfeus.banking" loggingLevel="INFO" message="Response ${body}"/>
            <doCatch>
                <exception>java.lang.Throwable
                </exception>
                <log logName="com.morfeus.banking" loggingLevel="ERROR" message="Exception occured ${exception}"/>
                <bean method="constructRestExceptionMessage(${exception},${property.objectMapper},${property.responseMapperId},${header.accept},${routeId})" ref="unmarshallBean"/>
            </doCatch>
        </doTry>
    </route>
</routes>
